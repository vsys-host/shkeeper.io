{% extends 'base.j2' %}

{% block body %}
    <div class="container login-container">
      <div class="row align-items-center h-100 common-text">
        <div class="col d-flex flex-column align-items-center justify-content-center">
          <img class="big-logo" width="200" src="{{ url_for('static', filename='images/shk-logo.' + theme + '.svg') }}" alt="logo" />

          {% for message in get_flashed_messages() %}
            <div class="alert alert-danger alert-danger__customization common-text" role="alert"><span class="icon">!!</span>{{ message }}</div>
          {% endfor %}

          <div class="card mx-auto" style="max-width: 550px;">
            <div class="card-body functional-card">
            <h3 class="mb-4 text-center title-text">Enable Two-Factor Authentication</h3>

              <h5 class="subtitle-text mb-2">Step 1: Scan QR Code</h5>
              <p class="card-text">Use your authenticator app (Google Authenticator, Authy, Microsoft Authenticator) to scan this QR code:</p>

              <div class="text-center">
                <div class="d-inline-block p-3 mb-3 rounded">
                  <img src="data:image/png;base64,{{ qr_code }}" alt="QR Code" class="img-fluid" style="max-width: 250px;" />
                </div>
              </div>

              <h5 class="subtitle-text mb-2">Step 2: Manual Entry (Optional)</h5>
              <p class="card-text mb-3">If you can't scan the QR code, enter this secret manually:</p>
              <div class="alert alert-secondary alert-secondary__customization mb-5 text-center text-break" style="font-family: monospace; font-size: 0.875rem;">
                {{ secret }}
              </div>

              <h5 class="subtitle-text mb-2">Step 3: Verify Code</h5>
              <p class="card-text mb-3">Enter the 6-digit code from your authenticator app to complete setup:</p>

              <form method="post">
                <div class="mb-5">
                  <input
                    type="text"
                    name="token"
                    class="form-control text-center"
                    style="font-size: 1.25rem; letter-spacing: 0.25em;"
                    placeholder="000000"
                    maxlength="6"
                    pattern="[0-9]{6}"
                    autocomplete="one-time-code"
                    inputmode="numeric"
                    autofocus
                    required
                  />
                </div>
                <div class="d-grid gap-2">
                  <button type="submit" class="btn btn-outline-primary btn-outline-primary__customization">
                  <span style="display: inline-block; transform: scale(1.5)"></span> &nbsp;
                  Enable 2FA</button>
                  <a href="{{ url_for('wallet.settings') }}" class="btn btn-outline-secondary btn-outline-secondary__customization"><span style="display:inline-block; transform: scale(1.2); vertical-align: -3px;">â†©</span> &nbsp;Cancel</a>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
{% endblock %}
